<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Load Balancer</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-slate-100 min-h-screen p-6">
    <div class="max-w-6xl mx-auto">
        <!-- Header -->
        <header class="mb-8">
            <h1 class="text-4xl font-bold text-blue-400 mb-2">Energy Load Balancer</h1>
            <p class="text-slate-400">Real-time home energy management system</p>
        </header>

        <!-- Power Sources Grid -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <!-- Grid Status -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-semibold text-slate-200">Grid Power</h2>
                    <svg class="w-8 h-8 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                </div>
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <span class="text-slate-400">Status:</span>
                        <span id="grid-status" class="font-semibold text-green-400">Online</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-slate-400">Load:</span>
                        <span id="grid-load" class="font-semibold">0%</span>
                    </div>
                    <div class="w-full bg-slate-700 rounded-full h-2 mt-2">
                        <div id="grid-load-bar" class="bg-green-400 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <!-- Battery Status -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-semibold text-slate-200">Battery</h2>
                    <svg class="w-8 h-8 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h11M9 21V3m0 0L5 7m4-4l4 4m8 12h-4m0 0v-4m0 4v-4m0 4h4"></path>
                    </svg>
                </div>
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <span class="text-slate-400">Charge:</span>
                        <span id="battery-level" class="font-semibold text-green-400">75%</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-slate-400">Status:</span>
                        <span id="battery-status" class="font-semibold">Charging</span>
                    </div>
                    <div class="w-full bg-slate-700 rounded-full h-2 mt-2">
                        <div id="battery-bar" class="bg-green-400 h-2 rounded-full transition-all duration-500" style="width: 75%"></div>
                    </div>
                </div>
            </div>

            <!-- Solar Status -->
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-semibold text-slate-200">Solar Panel</h2>
                    <svg class="w-8 h-8 text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                </div>
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <span class="text-slate-400">Generation:</span>
                        <span id="solar-power" class="font-semibold text-orange-400">2.5 kW</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-slate-400">Efficiency:</span>
                        <span id="solar-efficiency" class="font-semibold">85%</span>
                    </div>
                    <div class="text-sm text-slate-500 mt-2">Peak: 5.0 kW</div>
                </div>
            </div>
        </div>

        <!-- Total Power Consumption -->
        <div class="bg-slate-800 rounded-lg p-6 border border-slate-700 mb-8">
            <h2 class="text-2xl font-semibold mb-4 text-slate-200">Total Power Consumption</h2>
            <div class="flex items-end justify-between">
                <div>
                    <div class="text-5xl font-bold text-blue-400" id="total-power">0.0 kW</div>
                    <div class="text-slate-400 mt-2">Current Load</div>
                </div>
                <div class="text-right">
                    <div class="text-2xl font-semibold" id="power-source">Grid Power</div>
                    <div class="text-slate-400 text-sm mt-1">Primary Source</div>
                </div>
            </div>
        </div>

        <!-- Device Controls -->
        <div class="bg-slate-800 rounded-lg p-6 border border-slate-700 mb-8">
            <h2 class="text-2xl font-semibold mb-6 text-slate-200">Device Control</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- Air Conditioner -->
                <div class="bg-slate-700 rounded-lg p-4 border border-slate-600">
                    <div class="flex items-center justify-between mb-3">
                        <div>
                            <h3 class="font-semibold text-slate-200">Air Conditioner</h3>
                            <p class="text-sm text-slate-400">2.5 kW</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" class="sr-only peer device-toggle" data-device="ac" data-power="2.5">
                            <div class="w-11 h-6 bg-slate-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-500"></div>
                        </label>
                    </div>
                    <div class="text-xs text-slate-500">Priority: Medium</div>
                </div>

                <!-- Water Heater -->
                <div class="bg-slate-700 rounded-lg p-4 border border-slate-600">
                    <div class="flex items-center justify-between mb-3">
                        <div>
                            <h3 class="font-semibold text-slate-200">Water Heater</h3>
                            <p class="text-sm text-slate-400">1.5 kW</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" class="sr-only peer device-toggle" data-device="heater" data-power="1.5">
                            <div class="w-11 h-6 bg-slate-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-500"></div>
                        </label>
                    </div>
                    <div class="text-xs text-slate-500">Priority: Low</div>
                </div>

                <!-- Washing Machine -->
                <div class="bg-slate-700 rounded-lg p-4 border border-slate-600">
                    <div class="flex items-center justify-between mb-3">
                        <div>
                            <h3 class="font-semibold text-slate-200">Washing Machine</h3>
                            <p class="text-sm text-slate-400">1.0 kW</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" class="sr-only peer device-toggle" data-device="washer" data-power="1.0">
                            <div class="w-11 h-6 bg-slate-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-500"></div>
                        </label>
                    </div>
                    <div class="text-xs text-slate-500">Priority: Low</div>
                </div>

                <!-- Refrigerator -->
                <div class="bg-slate-700 rounded-lg p-4 border border-slate-600">
                    <div class="flex items-center justify-between mb-3">
                        <div>
                            <h3 class="font-semibold text-slate-200">Refrigerator</h3>
                            <p class="text-sm text-slate-400">0.5 kW</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" class="sr-only peer device-toggle" data-device="fridge" data-power="0.5" checked>
                            <div class="w-11 h-6 bg-slate-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-500"></div>
                        </label>
                    </div>
                    <div class="text-xs text-slate-500">Priority: High</div>
                </div>

                <!-- Lighting -->
                <div class="bg-slate-700 rounded-lg p-4 border border-slate-600">
                    <div class="flex items-center justify-between mb-3">
                        <div>
                            <h3 class="font-semibold text-slate-200">Lighting</h3>
                            <p class="text-sm text-slate-400">0.3 kW</p>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" class="sr-only peer device-toggle" data-device="lights" data-power="0.3" checked>
                            <div class="w-11 h-6 bg-slate-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-500"></div>
                        </label>
                    </div>
                    <div class="text-xs text-slate-500">Priority: High</div>
                </div>
            </div>
        </div>

        <!-- Activity Log -->
        <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
            <h2 class="text-2xl font-semibold mb-4 text-slate-200">Activity Log</h2>
            <div id="activity-log" class="space-y-2 max-h-64 overflow-y-auto">
                <div class="text-slate-400 text-sm">System initialized...</div>
            </div>
        </div>
    </div>

    <script>
        // System state
        const state = {
            grid: {
                status: 'online',
                load: 0,
                maxCapacity: 10 // kW
            },
            battery: {
                charge: 75, // percentage
                capacity: 10, // kWh
                charging: false
            },
            solar: {
                generation: 2.5, // kW
                efficiency: 85
            },
            devices: {
                ac: { power: 2.5, active: false, priority: 2 },
                heater: { power: 1.5, active: false, priority: 1 },
                washer: { power: 1.0, active: false, priority: 1 },
                fridge: { power: 0.5, active: true, priority: 3 },
                lights: { power: 0.3, active: true, priority: 3 }
            }
        };

        // Log activity
        function logActivity(message) {
            const log = document.getElementById('activity-log');
            const time = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = 'text-sm text-slate-300';
            entry.innerHTML = `<span class="text-slate-500">[${time}]</span> ${message}`;
            log.insertBefore(entry, log.firstChild);
            
            // Keep only last 20 entries
            while (log.children.length > 20) {
                log.removeChild(log.lastChild);
            }
        }

        // Calculate total power consumption
        function calculateTotalPower() {
            let total = 0;
            for (const device in state.devices) {
                if (state.devices[device].active) {
                    total += state.devices[device].power;
                }
            }
            return total;
        }

        // Update display
        function updateDisplay() {
            const totalPower = calculateTotalPower();
            
            // Update total power
            document.getElementById('total-power').textContent = totalPower.toFixed(1) + ' kW';
            
            // Update grid load
            const gridLoad = Math.min(100, (totalPower / state.grid.maxCapacity) * 100);
            state.grid.load = gridLoad;
            document.getElementById('grid-load').textContent = gridLoad.toFixed(0) + '%';
            document.getElementById('grid-load-bar').style.width = gridLoad + '%';
            
            // Update grid load bar color
            const loadBar = document.getElementById('grid-load-bar');
            if (gridLoad < 50) {
                loadBar.className = 'bg-green-400 h-2 rounded-full transition-all duration-500';
            } else if (gridLoad < 80) {
                loadBar.className = 'bg-yellow-400 h-2 rounded-full transition-all duration-500';
            } else {
                loadBar.className = 'bg-red-400 h-2 rounded-full transition-all duration-500';
            }
            
            // Update battery
            document.getElementById('battery-level').textContent = state.battery.charge.toFixed(0) + '%';
            document.getElementById('battery-bar').style.width = state.battery.charge + '%';
            document.getElementById('battery-status').textContent = state.battery.charging ? 'Charging' : 'Discharging';
            
            // Update solar
            document.getElementById('solar-power').textContent = state.solar.generation.toFixed(1) + ' kW';
            state.solar.efficiency = Math.min(100, (state.solar.generation / 5.0) * 100);
            document.getElementById('solar-efficiency').textContent = state.solar.efficiency.toFixed(0) + '%';
            
            // Determine power source
            let powerSource = 'Grid Power';
            if (state.solar.generation > totalPower) {
                powerSource = 'Solar Power';
            } else if (state.battery.charge > 20 && state.solar.generation < totalPower) {
                powerSource = 'Solar + Battery';
            }
            document.getElementById('power-source').textContent = powerSource;
        }

        // Auto load balancing
        function autoBalance() {
            const totalPower = calculateTotalPower();
            const availableSolar = state.solar.generation;
            
            // Update battery based on solar generation
            if (availableSolar > totalPower) {
                // Excess solar, charge battery
                state.battery.charging = true;
                state.battery.charge = Math.min(100, state.battery.charge + 0.5);
            } else if (availableSolar < totalPower && state.battery.charge > 20) {
                // Use battery to supplement
                state.battery.charging = false;
                state.battery.charge = Math.max(0, state.battery.charge - 0.3);
            }
            
            // Load shedding if grid overloaded
            if (state.grid.load > 80) {
                // Turn off lowest priority devices
                const sortedDevices = Object.entries(state.devices)
                    .filter(([_, device]) => device.active)
                    .sort((a, b) => a[1].priority - b[1].priority);
                
                if (sortedDevices.length > 0) {
                    const deviceToOff = sortedDevices[0];
                    state.devices[deviceToOff[0]].active = false;
                    document.querySelector(`[data-device="${deviceToOff[0]}"]`).checked = false;
                    logActivity(`⚠️ Load shedding: ${deviceToOff[0]} turned off (Grid overload)`);
                }
            }
        }

        // Simulate solar generation changes
        function simulateSolar() {
            // Random variation in solar generation (0-5 kW)
            const variation = (Math.random() - 0.5) * 0.5;
            state.solar.generation = Math.max(0, Math.min(5, state.solar.generation + variation));
        }

        // Device toggle event listeners
        document.querySelectorAll('.device-toggle').forEach(toggle => {
            toggle.addEventListener('change', function() {
                const device = this.dataset.device;
                const power = parseFloat(this.dataset.power);
                state.devices[device].active = this.checked;
                
                if (this.checked) {
                    logActivity(`✅ ${device.charAt(0).toUpperCase() + device.slice(1)} turned ON (${power} kW)`);
                } else {
                    logActivity(`⭕ ${device.charAt(0).toUpperCase() + device.slice(1)} turned OFF`);
                }
                
                updateDisplay();
            });
        });

        // Main update loop
        setInterval(() => {
            simulateSolar();
            autoBalance();
            updateDisplay();
        }, 3000);

        // Initial update
        updateDisplay();
        logActivity('⚡ Energy management system online');
    </script>
</body>
</html>